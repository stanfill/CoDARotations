riedist.Q4(Qs[1,],Q=Qs[3,])
rs<-rvmises(20,.001)
samp<-genBoth(rs)
Qs<-samp[[2]]
Rs<-samp[[1]]
Rhat<-mean.SO3(Rs)
Qhat<-mean.Q4(Qs)
Qdist<-rep(0,nrow(Qs))
Rdist<-rep(0,nrow(Rs))
for(i in 1:nrow(Qs)){
Qdist[i]<-riedist.Q4(Qs[i,],Qhat)
Rdist[i]<-riedist.SO3(Rs[i,],Rhat)
}
rd<-round(Rdist-Qdist,digits=5)
rd
r<-rvmises(20,0.01)
Qs<-genR(r,space="Q4")
Qp<-mean(Qs)
riedist.Q4(Qp)
sin(0)
QtoSO3(diag(1,3,3))
qu(diag(1,3,3))
QtoSO3(c(1,0,0,0))
acos(1)
2*acos(1)
2*acos(0)
2*acos(0)-p
2*acos(0)-pi
QtoSO3(c(0,1,0,0))
QtoSO3(c(0,0,1,0))
QtoSO3(c(0,0,0,1))
QtoSO3(c(1,0,0,0))
is.SO3(QtoSO3(c(1/sqrt(2),0,0,1/sqrt(2))))
source('//iastate.edu/cyfiles/stanfill/Desktop/GitHub/rotations/R/preliminary.R')
library(devtools)
install_github("rotations","heike")
remove.packages("rotations", lib="C:/Program Files/R/R-2.15.1/library")
.libPaths("C:/Program Files/R/R-2.15.1/library")
install_github("rotations","heike")
library(rotations)
?mean.Q4
rs<-rvmises(20)
Qs<-genR(rs,space="Q4")
Qs
mean(Qs)
mean(Qs,type='intrinsic')
library(rotations)
ang<-seq(-pi,pi,length=100)
plot(ang,1-cos(ang))
ang<-seq(-2*pi,2*pi,length=100)
plot(ang,1-cos(ang))
sin(pi)
sin(-pi)
remove.packages("rotations", lib="C:/Program Files/R/R-2.15.1/library")
.libPaths("C:/Program Files/R/R-2.15.1/library")
library(devtools)
library("devtools")
source('//iastate.edu/cyfiles/stanfill/Desktop/GitHub/rotations/R/preliminary.R')
r<-rvmises(20,0.01)
Rs<-genR(r)
Sp<-mean(Rs)
Sp
dist(Sp)
dist.SO3(Sp)
dist.SO3(Sp,method='riemannian')
dist.SO3(Sp,method='riemannia')
Sp
Sp2<-Sp%*%genR(pi/2)
Sp2<-Sp%*%matrix(genR(pi/2),3,3)
Sp2
class(Sp2)<-"SO3"
Sp2
Sp1
Sp
c(Sp,Sp2)
as.vector(Sp)
Rs<-genR(c(pi/4,pi/1))
Rs
length(Rs)
Rs[1:9]
t(Rs[1:9])
t(Rs)[1:9]
nrow(Rs)
source('//iastate.edu/cyfiles/stanfill/Desktop/GitHub/rotations/R/preliminary.R')
source('//iastate.edu/cyfiles/stanfill/Desktop/GitHub/rotations/R/preliminary.R')
source('//iastate.edu/cyfiles/stanfill/Desktop/GitHub/rotations/R/preliminary.R')
source('//iastate.edu/cyfiles/stanfill/Desktop/GitHub/rotations/R/preliminary.R')
Rs
Rs<-genR(rvmises(20))
Rs
n<-nrow(Rs)
Shat<-mean(Rs)
Shat
B
B<-1000
That<-rep(NA, length=B)
samp<-sample(1:n,m,replace=T)
m<-1
m<-n
samp<-sample(1:n,m,replace=T)
ShatStar<-fun(Rs[samp,],...)
ShatStar<-mean.SO3(Rs[samp,])
ShatStar
dist.SO3(c(Shat,ShatStar))
nrow(c(Shat,ShatStar))
if(NULL)
{i<-1}
NULL|T
NULL||T
NULL||F
is.NULL
is.NULL(NULL)
?NULL
is.null(NULL)
Rs
Rs<-Rs[1:2]
Rs<-genR(rvmises(2))
Rs
is.matrix(Rs)
source('//iastate.edu/cyfiles/stanfill/Desktop/GitHub/rotations/R/preliminary.R')
Rs<-1:18
Rs
if(is.matrix(Rs) && nrow(Rs)==2){
#If Rs is in a 2x9 matrix, the rows correspond to rotations
R1<-matrix(Rs[1,],3,3)
R2<-matrix(Rs[2,],3,3)
}else if(length(Rs)==9){
#If only one rotation is given assume the other to be the identity matrix
R1<-matrix(Rs,3,3)
R2<-diag(1,3,3)
}else if(length(Rs)==18){
#This allows input of the from c(R1,R2)
R1<-matrix(Rs[1:9],3,3)
R2<-matrix(Rs[10:18],3,3)
}else{
stop("Data is not in a usable form.  See help(dist.SO3).")
}
R1
R2
F&&NULL
source('//iastate.edu/cyfiles/stanfill/Desktop/GitHub/rotations/R/preliminary.R')
Shat
ShatStar
dist.SO3(c(Shat,ShatStar))
eangle(t(Shat)%*%ShatStar)
Rs<-c(Shat,ShatStar)
Rs
if(is.matrix(Rs) && nrow(Rs)==2){
#If Rs is in a 2x9 matrix, the rows correspond to rotations
R1<-matrix(Rs[1,],3,3)
R2<-matrix(Rs[2,],3,3)
}else if(length(Rs)==9){
#If only one rotation is given assume the other to be the identity matrix
R1<-matrix(Rs,3,3)
R2<-diag(1,3,3)
}else if(length(Rs)==18){
#This allows input of the from c(R1,R2)
R1<-matrix(Rs[1:9],3,3)
R2<-matrix(Rs[10:18],3,3)
}else{
stop("Rs is not in a usable form.  See help(dist.SO3).")
}
R1
R2
source('//iastate.edu/cyfiles/stanfill/Desktop/GitHub/rotations/R/preliminary.R')
as.SO3(Rs)
as.matrix
library(rotations)
rm(list=ls())
1/(2+3*sqrt(2))
(1/(2+3*sqrt(2)))*50
(sqrt(2)/(2+3*sqrt(2)))*50
8+8+11+11+12
remove.packages("rotations", lib="C:/Program Files/R/R-2.15.1/library")
.libPaths("C:/Program Files/R/R-2.15.1/library")
library(devtools)
?library
.libPaths()
x<-seq(0,10,length=1000)
plot(x,sqrt(x))
n<-32
ni<-4
B<-8
X2<-kronecker(rep(1,8),diag(1,4))
X2
X1<-kronecker(diag(1,8),rep(1,4))
X1
.9^4+4*.9^4*.1
critF<-qf(.9,3,21)
type2error<-function(lambda,cF){
return((pf(cF,3,21,lambda)-.5)^2)
}
ncp1<-optimize(f=type2error,interval=c(0,6),cF=critF)$minimum
lam<-seq(0,20,length=100)
plot(lam,pf(critF,3,21,lam),type='l',xlab="Non-centrality parameter",ylab="P(Type II Error)")
abline(v=ncp1,h=0.5)
points(ncp1,0.5)
points(ncp1,0.5,pch="character")
points(ncp1+0.1,0.5,pch="character")
points(ncp1+0.1,0.50.1,pch="character")
points(ncp1+0.1,0.50+.01,pch="character")
points(ncp1+0.1,0.50+.01,pch="lambad")
plot(lam,pf(critF,3,21,lam),type='l',xlab="Non-centrality parameter",ylab="P(Type II Error)")
abline(v=ncp1,h=0.5)
points(ncp1+0.2,0.50+.05,pch="c")
points(ncp1+0.2,0.50+.05,pch=expression(lambda))
points(ncp1+0.2,0.50+.05,pch="lambda")
plot(lam,pf(critF,3,21,lam),type='l',xlab="Non-centrality parameter",ylab="P(Type II Error)")
abline(v=ncp1,h=0.5)
points(ncp1+0.2,0.50+.05,pch="lambda")
points(ncp1+0.2,0.50+.05,pch="4.84")
plot(lam,pf(critF,3,21,lam),type='l',xlab="Non-centrality parameter",ylab="P(Type II Error)")
abline(v=ncp1,h=0.5)
points(ncp1+0.2,0.50+.05,pch="4.84")
points(ncp1+0.2,0.50+.05,pch=4.84)
plot(lam,pf(critF,3,21,lam),type='l',xlab="Non-centrality parameter",ylab="P(Type II Error)")
abline(v=ncp1,h=0.5)
points(ncp1+0.2,0.50+.05,pch=4.84)
optB<-function(b){
ncp2<-4.84*b/8
df2<-3*(b-1)
Fc<-qf(.9,3,df2)
power<-pf(Fc,3,df2,ncp2,lower.tail=F)
return((power-.9)^2)
}
trys<-2:30
plot(trys,optB(trys))
bopt<-round(optimize(optB,interval=c(2,40))$minimum,digits=0)
bopt
ncp2<-bopt*ncp1/8
critF<-qf(.9,3,21)
type2error<-function(lambda,cF){
return((pf(cF,3,21,lambda)-.5)^2)
}
ncp1<-optimize(f=type2error,interval=c(0,6),cF=critF)$minimum
lam<-seq(0,20,length=100)
plot(lam,pf(critF,3,21,lam),type='l',xlab="Non-centrality parameter",ylab="P(Type II Error)")
abline(v=ncp1,h=0.5)
ncp2<-bopt*ncp1/8
Fc<-qf(.9,3,3*(21-1))
pf(Fc,3,3*(21-1),ncp2,lower.tail=F)
bopt<-round(optimize(optB,interval=c(2,40))$minimum,digits=0)
bopt
ncp2<-bopt*ncp1/8
Fc<-qf(.9,3,3*(bopt-1))
pf(Fc,3,3*(bopt-1),ncp2,lower.tail=F)
Fc<-qf(.9,3,3*11)
kronecker(rep(1,3),diag(1,3))
library(MASS)
data<-c(0.51,0.56,0.52,0.53,0.52,0.59,0.55,0.43,0.53,0.58,0.42,0.45,0.48,0.47,0.41,0.38)
matrix(data,4,4,byrow=T)
I4<-diag(1,4)
t1<-I4[1,];t2<-I4[2,];t3<-I4[3,];t4<-I4[4,]
X2<-matrix(c(t1,t2,t3,t4,t2,t3,t4,t1,t3,t4,t1,t2,t4,t1,t2,t3),16,4,byrow=T)
X1<-cbind(kronecker(diag(1,4),rep(1,4)),kronecker(rep(1,4),diag(1,4)))
H1<-X1%*%ginv(t(X1)%*%X1)%*%t(X1)
tauHat<-ginv(t(X2)%*%(diag(1,16)-H1)%*%X2)%*%t(X2)%*%(diag(1,16)-H1)%*%data
bigX<-cbind(X1,X2)
bigH<-bigX%*%ginv(t(bigX)%*%bigX)%*%t(bigX)
SST<-t(data)%*%(bigH-H1)%*%data
SST
dfT<-4-1
SSE<-t(data)%*%(diag(1,16)-bigH)%*%data
SSE
dfE<-6
Fval<-(SST/dfT)/(SSE/dfE)
Fval
pval<-pf(Fval,dfT,dfE,lower.tail=F)
pval
tauHat
dim(bigX)
bigParms<-ginv(t(bigX)%*%bigX)%*%t(bigX)%*%data
bigParms
Eis<-bigX%*%bigParms
Eis
tauHat
cheat<-lm(data~X1[,1:4]+X1[,5:8]+X2)
anova(cheat)
summary(cheat)
str(cheat)
cheat$fitted.values
Eis
cheat$fitted.values-Eis
Pson<-sum((data-Eis)^2/Eis)
Pson
SST
SSE
SSE/dfE
Eis<-100*bigX%*%bigParms
Pson<-sum((100*data-Eis)^2/Eis)
Pson
Tval<-SSE/varHat
varHat<-mean(data)*(1-mean(data))/100
varHat
chiHat<-t(data)%*%(diag(1,16)-bigH)%*%data/varHat
pval<-pchisq(chiHat,6,lower.tail=F)
pval
Tval<-SSE/varHat
Tval
pval<-pt(Tval,16-1,lower.tail=F)
pval
chiHat
SSE
SSE/varHat
qr(diag(1,16)-bigH)%rank
qr(diag(1,16)-bigH)$rank
y<-c(1.23,.159,1.37,1.28,1.83,1.71,7.22,1.64,1.17,1.65,1.18,1.44,1.36,1.27,1.52,1.03)
y<-c(1.23,1.59,1.37,1.28,1.83,1.71,7.22,1.64,1.17,1.65,1.18,1.44,1.36,1.27,1.52,1.03)
var(data)
SSE
6*26
df<-seq(0,10,length=10)
plot(df,df^2-4*df+3)
abline(h=0)
df
df<-seq(0,10,length=11)
df
plot(df,df^2-4*df+3)
abline(h=0)
setwd("U:/Thesis/WriteUps/9-21-12TailError")
#This csv file was written in 'TailBehaviorCode.R'
library(rotations)
library(splines)
qplot(Prop,Pdiff,data=alldf[alldf$n!=10,],colour=Dist,xlab="Proportion Observations in Tail",ylab="Mean Error-Median Error",alpha=I(.5))+
geom_hline(yintercept=0,colour="gray50")+facet_grid(n~.,scales="free_y")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.6))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.6))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.6))
alldf<-read.csv("Nu75TailBehavior.csv")
alldf$Dist<-factor(alldf$Dist,levels=levels(alldf$Dist)[c(1,3,2)])
tail75<-mean(c(2.109,2.185,1.975))
realProbs<-rep(0,3)
realProbs[1]<-integrate(dcayley,lower=tail75,upper=pi,Haar=F,kappa=2)$value*2
realProbs[2]<-integrate(dfisher,lower=tail75,upper=pi,Haar=F,kappa=1.15)$value*2
realProbs[3]<-integrate(dvmises,lower=tail75,upper=pi,Haar=F,kappa=0.52)$value*2
ggplot(alldf[alldf$n>10,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(colour=Dist),alpha=I(.4))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
dirname(file.choose())
rm(list=ls())
setwd("\\\\iastate.edu/cyfiles/stanfill/Desktop/GitHub/CoDARotations")
library(rotations)
library(splines)
alldf<-read.csv("Nu75TailBehavior.csv")
alldf$Dist<-factor(alldf$Dist,levels=levels(alldf$Dist)[c(1,3,2)])
tail75<-mean(c(2.109,2.185,1.975))
realProbs<-rep(0,3)
realProbs[1]<-integrate(dcayley,lower=tail75,upper=pi,Haar=F,kappa=2)$value*2
realProbs[2]<-integrate(dfisher,lower=tail75,upper=pi,Haar=F,kappa=1.15)$value*2
realProbs[3]<-integrate(dvmises,lower=tail75,upper=pi,Haar=F,kappa=0.52)$value*2
ggplot(alldf[alldf$n>10,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(colour=Dist),alpha=I(.4))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>10,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.4))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>10,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist))+theme_bw()
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>10,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist))+theme_bw()+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>10,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist))+theme_bw()+scale_shape_manual(values=c(1,2,3))
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>10,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist))+theme_bw()+scale_shape_manual(values=c(1,2,3))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>10,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.4))+theme_bw()+scale_shape_manual(values=c(16,5,17))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>10,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+scale_shape_manual(values=c(16,5,17))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>100,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+scale_shape_manual(values=c(16,0,17))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>99,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
geom_vline(xintercept=realProbs[1],colour=2,alpha=I(.5))+
geom_vline(xintercept=realProbs[2],colour=3,alpha=I(.5))+
geom_vline(xintercept=realProbs[3],colour=4,alpha=I(.5))+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+scale_shape_manual(values=c(16,0,17))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>99,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+scale_shape_manual(values=c(16,0,17))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))+
stat_summary(fun.data="mean",geom="point")
ggplot(alldf[alldf$n>99,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+scale_shape_manual(values=c(16,0,17))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))+
stat_summary(fun.data="mean")
ggplot(alldf[alldf$n>99,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+scale_shape_manual(values=c(16,0,17))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggplot(alldf[alldf$n>99,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+scale_shape_manual(values=c(16,0,17))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggsave("Nu75TailBehavior.pdf",width=8,height=4)
setwd("\\\\iastate.edu/cyfiles/stanfill/Desktop/GitHub/CoDARotations/images")
ggplot(alldf[alldf$n>99,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+scale_shape_manual(values=c(16,0,17))+
facet_grid(n~.,scales="free_y",labeller=label_bquote(n==.(x)))
ggsave("Nu75TailBehavior.pdf",width=8,height=4)
ggplot(alldf[alldf$n>299,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+scale_shape_manual(values=c(16,0,17))
ggplot(alldf[alldf$n>299,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+
scale_shape_manual(values=c(16,0,17))+
theme(legend.text=element_text(size=14),legend.title=element_text(size=16))
ggplot(alldf[alldf$n>299,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+
scale_shape_manual(values=c(16,0,17),name="Distribution")+
theme(legend.text=element_text(size=14),legend.title=element_text(size=16))
ggplot(alldf[alldf$n>299,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+
ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+
scale_shape_manual(values=c(16,0,17),name="Distribution")+
theme(legend.text=element_text(size=14),legend.title=element_text(size=16))
ggsave("Nu75N300TailBehavior.pdf",width=6,height=4)
ggplot(alldf[alldf$n>299,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+
ylab(expression(d[G](widehat(bold(S))[E],bold(S))-d[G](widetilde(bold(S))[E],bold(S))))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+
scale_shape_manual(values=c(16,0,17),name="Distribution")+
theme(legend.text=element_text(size=12),legend.title=element_text(size=14))
ggsave("Nu75N300TailBehavior.pdf",width=8,height=4)
ggplot(alldf[alldf$n>299,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+
ylab(expression(d[G](bold(S),widehat(bold(S))[E])-d[G](bold(S),widetilde(bold(S))[E])))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+
scale_shape_manual(values=c(16,0,17),name="Distribution")+
theme(legend.text=element_text(size=12),legend.title=element_text(size=14))
ggplot(alldf[alldf$n>299,],aes(Prop,Pdiff))+xlab("Proportion Observations in Tail")+
ylab(expression(d[G](bold(S),widehat(bold(S))[E])-d[G](bold(S),widetilde(bold(S))[E])))+
geom_hline(yintercept=0,colour="gray50")+
stat_smooth(method=lm,formula=y~ns(x,2),fullrange=T,colour=1)+
geom_point(aes(shape=Dist),alpha=I(.6))+theme_bw()+
scale_shape_manual(values=c(16,0,17),name="Distribution")+
theme(legend.text=element_text(size=12),legend.title=element_text(size=14))
ggsave("Nu75N300TailBehavior.pdf",width=8,height=4)
