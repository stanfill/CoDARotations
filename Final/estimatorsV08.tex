 % !TEX root = Stanfill_CoDA.tex
\section{Location Estimators}\label{sec:estimators}
This section describes four estimators for the location parameter $\bm{S}\in SO(3)$ corresponding to orientation data generated by the model in (\ref{eqn:1}). The estimators are based on two different choices. First, the choice whether to use the embedding approach, i.e.~to base the estimator on the Euclidean distance metric  defined in (\ref{d_E}) or, alternatively, to use the intrinsic approach by employing the Riemannian distance metric as defined in (\ref{d_R}). The second choice concerns the decision-theoretic loss functions, i.e., either using squared deviations  (an $L_2$-norm) or  absolute deviations (an $L_1$-norm).  The extent to which the choice of geometry or loss function matters in the estimation of $\bm{S}$ will be an important aspect explored in Section~\ref{ch:simulation}.  We provide an overview of all four estimators and their properties in Table~\ref{tab:ests.sum}.

%\begin{center}
\begin{table}[h]
\caption{An overview of the estimators and their underlying geometry and loss function.}  \label{tab:ests.sum}
\centering
\begin{tabular}{ lclclcl}\hline
\rule[2mm]{0mm}{1mm} \textbf{Estimator name} & & \textbf{Denoted} & & \textbf{Distance} &&\textbf{Minimizer of}\\ 
\rule[2mm]{0mm}{1mm}  & &  & & \textbf{metric} &&\textbf{loss function}\\ 
\hline \hline 
\rule[2mm]{0mm}{6mm} Projected Arithmetic Mean & & $\ProjMean$ & & Euclidean &&$\sum_{i=1}^n d^2_E$  \\
\rule[2mm]{0mm}{6mm} Projected Median & & $\ProjMedian$ & & Euclidean && $\sum_{i=1}^n\Edist$ \\
\rule[2mm]{0mm}{6mm} Geometric Mean & & $\GeomMean$&  & Riemannian && $\sum_{i=1}^n d^2_R$\\
\rule[2mm]{0mm}{6mm} Geometric Median & & $\GeomMedian$&  & Riemannian &&$\sum_{i=1}^n\Rdist$ \\[-7mm] 
\rule[2mm]{0mm}{6mm} & & & & \\ \hline
\end{tabular}
\end{table}
%\end{center}

\subsection{The projected arithmetic mean}
\label{subsec:pam}

We begin with the definition of the arithmetic mean for orientation data, as its analog is most frequently encountered in the statistical literature for directional data \citep[e.g.,~see][]{mardia00}.   For a sample of $n$ random rotations $\bm{R}_i\in SO(3)$, $i=1,2,\dots,n$, this mean-type estimator is defined as
\begin{equation}\label{est:pam}
\ProjMean=\argmin_{\bm{S}\in
SO(3)}\sum_{i=1}^n d^2_E(\bm{R}_i,\bm{S})=\argmax_{\bm{S}\in
SO(3)}\tr(\bm{S}^{\top}\bar{\bm{R}})
\end{equation}
where $\bar{\bm{R}}=\frac{1}{n}\sum_{i=1}^n\bm{R}_i$. The estimator is obtained by minimizing the sum of the squared deviations in the Euclidean sense in the ambient space $\M(3)$, which then is projected back into $SO(3)$. \citet{moakher02}, who studied the mathematical characteristics of this estimator in detail, therefore refers to it as the \textit{projected arithmetic mean}.    This estimator's appeal lies in its simplicity and statistically intuitive nature, though it has been noted that the estimator is not invariant under rigid transformations \citep[see][]{moakher02}.  However, the estimator does correspond to the maximum likelihood estimator of $\bm{S}$ when the symmetrically distributed rotation errors in (\ref{eqn:1}) follow a matrix Fisher distribution \citep{jupp79}.  \citet{leon06} also derived this estimator as the method of moment estimator under a Cayley  distribution, and \citet{bingham09} showed that the projected arithmetic mean corresponds to the maximum quasi-likelihood estimator for orientation data with rotation errors arising from the circular-von Mises-based distribution.  For a numerical implementation of $\ProjMean$ we refer to algorithms proposed by \citet{arun87} and \citet{horn88} as well as to \citet{umeyama91} for refinements of their solutions including special cases such as $\det(\bar{\bm R})=0$.

\subsection{The projected median}
\label{subsec:med}

Previously proposed estimators for $X_1, \ldots,X_n \in \mathbb{R}^p$  include, for example, the Euclidean median (also known as the Weber point \citep{bajaj88}), the mediancentre \citep{gower74} or the projection median \citep{durocher09}. %Specifically, \cite{durocher09} explore the stability of the above-mentioned estimators with respect to small perturbations at a small, selected set of points.  
For directional and spherical data, exemplary estimators include the circular median \citep{mardia72}, the normalized spatial median \citep{ducharme87} and the Fisher median \citep{fisher85} also known as the spherical median. \citet{chan93} compare the performance of the normalized spatial median,  an $L_1$ estimator on the sphere by \cite{he92} and the Fisher median for the central direction for spherical data following the von Mises-Fisher distribution. They conclude that the normalized spatial median estimator is preferable for spherical data under the von Mises-Fisher model. 

A modification of the estimator from Section~\ref{subsec:pam} \red{in line with these proposals} is obtained by replacing the squared distances in \eqref{est:pam} with absolute distances, leading to a median-type estimator defined as
\begin{equation}\label{est:med}
\ProjMedian=\argmin_{\bm{S}\in
SO(3)}\sum_{i=1}^n\Edist(\bm{R}_i,\bm{S}).
\end{equation}
We will refer to this estimator of $\bm{S}$ as the \textit{projected median}.  %To the best of our knowledge, the estimator defined in (\ref{est:med}) is the first median-type estimator for $SO(3)$ data.\\
Although median-type estimators exist for high dimensional and directional  high dimensional  data, such estimators have not been defined for rotational data. 

We next propose an algorithm to compute the projected median (\ref{est:med}).  We base our method on the Weiszfeld algorithm originally given by \cite{weiszfeld37}.  The algorithm requires an initial value that does not equal any sample point.   Note that the solution is generally not sensitive to the choice of starting points unless the data exhibit extreme spread.
\begin{enumerate}
\item Set $\widehat{\bm S}=\ProjMean$ and choose an arbitrarily small stopping rule $\varepsilon$.
\item For $i=1,\ldots,n$ compute $\bm s_i=\bm R_i-\widehat{\bm S}$.
\item Calculate
\[
\bar{\bm R}_W=\frac{\sum_{i=1}^n\bm R_i/||\bm s_i||_F}{\sum_{i=1}^n1/||\bm s_i||_F}
\]
which we call the weighted mean with respect to $\widehat{\bm S}$. \red{Note that in theory the probability that $||\bm s_i||_F = 0$ is zero, but in practice we impose a lower limit on $||\bm s_i||_F = \delta > 0$ (for some $\delta \in \mathbb R$) to avoid an undefined result.} 
\item Define $\widehat{\bm S}_{\text{new}} = \argmax_{\bm{S}\in
SO(3)}\tr(\bm{S}^{\top}\bar{\bm{R}}_W)$ as the $\mathcal{M}(3)$ projection of $\bar{\bm R}_W$; see (\ref{est:pam}).
\item If $\varepsilon>||\widehat{\bm S}-\widehat{\bm S}_{\text{new}}||_F$ return $\ProjMedian=\widehat{\bm S}_{\text{new}}$; otherwise set $\widehat{\bm S}=\widehat{\bm S}_{\text{new}}$ and return to step 2.
\end{enumerate}
\red{The intuition behind this algorithm is as follows.  Given a current estimate of the center we can update that estimate by computing the weighted average of the data with weights are equal to the inverse of each observations distance from the estimated center.  In this way, observations further from the current estimate of center get less weight than those closer to the center.  This process results in $\bar{\bm R}_W$, which is not in $SO(3)$ therefore we find the rotation closest to it which is $\widehat{\bm S}$.  Repeat this process until the current and new estimate are sufficiently close.}

\subsection{The geometric mean}
\label{section:ltwo}
As sketched in Section~\ref{subsec:geometry}, the Lie group property of $SO(3)$ provides us with a convenient transform from $SO(3)$
into the tangent space $\mathfrak{so}(3)$ that is closed under
addition and scalar multiplication.  Obtaining the median or mean
in this transformed space and projecting the result back to $SO(3)$ corresponds to the rotation that minimizes the first and second order Riemannian
distances, respectively \citep{karcher77, moakher02, fletcher08, fletcher09}.  \citet{karcher77} made use of Riemannian manifolds to compute what is often called the Riemannian
center of mass.  \citet{moakher02} applied Karcher's ideas to
rotation matrices and defined
\begin{equation}\label{est:ltwo}
\GeomMean=\argmin_{\bm{S}\in
SO(3)}\sum_{i=1}^n d^2_{R}(\bm{R}_i,\bm{S}).
\end{equation}
which was termed as the \textit{geometric mean}.  Note that the solution to  \eqref{est:ltwo} may not be
unique. Uniqueness is tied to the property of geodesic convexity of the objective function in \eqref{est:ltwo}. For more information, we refer to \citet{moakher02}.  Additionally, \eqref{est:ltwo} generally does not have a closed-form solution making this estimator much more computationally intensive than its Euclidean counterpart (the projected arithmetic mean of Section~\ref{subsec:pam}).  We used the algorithm proposed by \citet{manton04} for implementation in our simulation study.

\subsection{The geometric median}
\label{subsec:lone}
The median-type counterpart to the geometric mean was defined first in the context of
spherical data by \citet{fisher85} as the point on the sphere that minimizes the sum of the arc lengths to all
observations in the sample.   For this type of data, the resulting estimator is known as the spherical median,
 which is a special case of the generalized median in $\R^d$
proposed by \citet{gower74}.   For spherical data, an alternative formulation to the
spherical median has been given by \citet{liu92} in the framework of
data depth leading, however, to the same solution. We give an adaptation of the spherical median to rotation matrices. 
Recall that the shortest geodesic path between two rotations ${\bm R_1}$, ${\bm R_2}$ is given by the Riemannian distance $\Rdist(\bm R_1,\bm R_2)$.  Thus the rotation matrix analog of the \cite{fisher85} spherical
median can be defined as
\begin{equation}\label{est:lone}
\GeomMedian=\argmin_{\bm{S}\in
SO(3)}\sum_{i=1}^n\Rdist(\bm{R}_i,\bm{S});
\end{equation}
see also \cite{fletcher08, fletcher09}.  We refer to this estimator of $\bm{S}$ as the \textit{geometric median.}  \citet{hartley11} offers an algorithm to find the geometric median in $SO(3)$.

